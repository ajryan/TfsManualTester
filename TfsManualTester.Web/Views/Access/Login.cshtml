@{
    ViewBag.Title = "Login";
}

@section scripts
{
    <script>
        $(document).ready(function () {

            var $loginError = $('#loginError');
            
            $('#submit').live(
                'click',
                function(event) {
                    event.preventDefault();

                    var formData = $('#loginForm').serialize();
                    console && console.log('formData', formData);
                    
                    $.ajax({
                        url: '@Url.Action("TfsLogin")',
                        data: formData,
                        type: 'POST',
                        success: function (data) {
                            console && console.log('data', data);
                            if (data.Success === false) {
                                showLoginError(data.ErrorMessage);
                            }
                        },
                        error: function (xhr, status, error) {
                            console && console.log('status', status);
                            console && console.log('error', error);

                            showLoginError(status + ': ' + error);
                        }
                    });
                }
            );

            function showLoginError(message) {
                $loginError.text(message);
                $loginError.fadeTo(200, 1);
            }
            
            $loginError
                .hide()
                .ajaxStart(function() {
                    $loginError.fadeTo(200, 0);
                });
            
        });
    </script>
}

<h2>Login</h2>

<form id="loginForm">
    <label for="tfsUrl">Tfs Url:</label><input id="tfsUrl" name="tfsUrl" type="text" /><br/>
    <label for="userName">Username:</label><input id="userName" name="userName" type="text" /><br/>
    <label for="password">Password:</label><input id="password" name="password" type="password" /><br/>
    <button id="submit" type="submit">Login</button>
</form>

<div id="loginError" style="display: none">
    
</div>